{% extends 'layouts/app.html' %}
{% import "components/modal.html" as modal %}

{% block content %}
<table>
    <thead>
        {% for column in items.keys() %}
            <th>{{ column }}</th>
        {% endfor %}
    </thead>
    <tbody>
        {% for row in items %}
            <tr>
                <td>{{row.user_id}}</td>
                <td>{{row.billing_date}}</td>
                <td>{{row.plan}}</td>
                <td>{{row.sum}}</td>
            </tr>
        {% endfor %}    
    </tbody>
</table>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('alpine:init', () => {
        
        Alpine.store('contentStore', {
            title: 'testing',
            description: '',
            director: '',
            genre: '',
            language: '',
            content_type: '',
            medias: {},
            getData(contentId) {
                // Make an Ajax request using Axios
                axios.get('{{url_for("contentMetadata")}}',{
                    params: {
                        contentId: contentId,
                    }
                })
                .then(response => {
                    // Set the data to a variable accessible in the component
                    console.log(response);
                    if(response.data.length > 0){
                        this.title = response.data[0].title;
                        this.director = response.data[0].director;
                        this.description = response.data[0].description;
                        this.genre = response.data[0].genres;
                        this.language = response.data[0].languages;
                        this.content_type = response.data[0].content_type;
                        this.medias = response.data;
                    }
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
            }
        })
    });
</script> 
{% endblock %}
